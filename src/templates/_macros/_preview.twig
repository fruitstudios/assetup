{% import "assetup/_macros" as macros %}

{% set asset = asset ?? false %}
{% set name = name ?? false %}
{% set transform = transform ?? false %}

{% if asset %}

    {% set preview = asset.kind != 'image' ? 'file' : (preview ?? 'image') %}

    {% if not transform %}
        {% set transform = {
            mode: 'crop',
            width: 400,
            height: 400,
            quality: 90,
            position: 'center-center'
        } %}
    {% endif %}


    {% set classes = [
        'assetup--asset',
        'assetup--assetPreview-' ~ preview,
    ]|filter|join(' ') %}

    {% set attributes = [
        preview == 'background' ? 'style="background-image: url('~asset.url(transform)~');"' : null,
    ]|filter|join(' ') %}

    <li class="{{ classes }}"{{ attributes|raw }}>

        {% if enableRemove %}
            <a class="assetup--remove">
                {# Remove #}

                <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 64 64">
                  <title>close-svg</title>
                  <path d="M32.202 27.36L58.62.944c1.226-1.225 3.212-1.225 4.437 0s1.225 3.21 0 4.437L36.64 31.8l26.417 26.418c1.225 1.225 1.225 3.212 0 4.437s-3.21 1.225-4.437 0l-26.418-26.42L5.784 62.653c-1.225 1.225-3.212 1.225-4.437 0s-1.225-3.212 0-4.437l26.418-26.418L1.347 5.38C.122 4.154.122 2.168 1.347.943s3.212-1.225 4.437 0L32.202 27.36z"/>
                </svg>
            </a>
        {% endif %}

        {# Handle
            TODO: Hook up drag handle
            {% if enableReorder %}
                <span class="assetup--handle"></span>
            {% endif %}

        #}

        {% switch preview %}

            {% case "file" %}
                {{ macros.icon({ icon: 'file' }) }}
                {{ asset.filename }}

            {% case "image" %}
                <img src="{{ asset.url(transform) }}" alt="{{ asset.title }}" />
                {{ asset.filename }}

            {% case "background" %}
                 <img src="{{ asset.url(transform) }}" alt="{{ asset.title }}" />
                {{ asset.filename }}


        {% endswitch %}

        {% if name %}
            {% set name = name|replace({'[]': ''}) ~ '[]' %}
            <input type="hidden" name="{{ name }}" value="{{ asset.id }}">
        {% endif %}

    </li>

{% endif %}




